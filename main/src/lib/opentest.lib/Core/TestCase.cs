namespace ProtoLab.OpenTest;

public sealed class TestCase
{
    private MethodInfo Test { get; }

    public string Name => Test.Name;
    public CaseLogs CaseLogs { get; private set; }

    internal TestCase(MethodInfo testMethod)
    {
        Test = testMethod;
        CaseLogs = new(Name);
    }

    public static implicit operator TestCase(MethodInfo m) =>
        new(m);

    internal void BeginTest(object target) => ExecuteTest(() =>
        Test.Invoke(target, null));

    internal void EndTest()
    {
        CaseLogs.Close();
    }

    private static void ExecuteTest(Action test) =>
        test();
}
