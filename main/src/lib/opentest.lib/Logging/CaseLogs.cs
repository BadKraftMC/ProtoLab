using System.Text.Json.Serialization;

namespace ProtoLab.OpenTest;

public class CaseLogs
{
    [JsonIgnore]
    internal Output Output { get; private set; }

    public string Method { get; }
    public List<Output> Logs { get; } = new();

    public CaseLogs(string testName)
    {
        Method = testName;
        Output = null;
    }

    internal void BeginAssert()
    {
        if (Output != null && Output.HasOutput)
        {
            Logs.Add(Output);
        };

        Output = new ResultLogs();
    }

    internal void EndAssert()
    {
        Logs.Add(Output);
        Output = null;
    }

    internal void Log(string logEntry)
    {
        //  if we end up with a double entry this is where to start looking
        var output = Output ?? (Output = new AgentLogs());
        output.Log(logEntry);
    }
    internal void Close()
    {
        if (Output != null && Output.HasOutput)
        {
            Logs.Add(Output);
        };
    }
}
